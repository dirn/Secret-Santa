!function(e){var t=e(window),n=e(document.body),r=e(".navbar").outerHeight(!0)+10;n.scrollspy({target:".xmas-sidebar",offset:r});t.on("load",function(){n.scrollspy("refresh")});e(".xmas-container [href=#]").click(function(e){e.preventDefault()});setTimeout(function(){var t=e(".xmas-sidebar");t.affix({offset:{top:function(){var n=t.offset().top,r=parseInt(t.children(0).css("margin-top"),10),i=e(".xmas-main-nav").height();return this.top=n-i-r}}})},100);setTimeout(function(){e(".xmas-top").affix()},100);e(".xmas-section").on("click","button",function(){var t=e(this),n=t.data("id"),r="",i="POST";if(t.hasClass("xmas-claim"))r="/claim";else if(t.hasClass("xmas-unclaim"))r="/unclaim";else if(t.hasClass("xmas-purchase")){r="/purchase";i="PUT"}else if(t.hasClass("xmas-return")){r="/return";i="PUT"}e.ajax({url:r,type:i,data:{id:n}}).done(function(e){t.closest(".xmas-item").replaceWith(e)})});e(".xmas-wishlist").on("click","button",function(t){var n=e(this),r=n.closest(".xmas-item");if(n.hasClass("btn-add"))return;if(n.hasClass("btn-cancel")){r.find("form").remove();r.find(".btn-group").show();return}t.preventDefault();var s=n.closest(".xmas-wishlist").find("form").attr("action");s+="/"+n.data("id");var o="",u={},a=null;if(n.hasClass("btn-edit")){o="GET";a=function(e){r.find(".btn-group").hide();r.append(e);i(r.find("input[name=quantity]"))}}else if(n.hasClass("btn-update")){o="PUT";u=n.closest("form").serialize();a=function(e){if(e=="OK"){r.find("form").remove();r.find(".btn-group").show()}else r.html(e)}}else if(n.hasClass("btn-delete")){if(!confirm("Are you sure you want to delete "+r.find("h3").html()+"?"))return;o="DELETE";a=function(){r.parent().remove()}}e.ajax({url:s,type:o,data:u}).done(a)});var i=function(t){var n=e(t),r=e("<p/>");r.insertAfter(n.parent());var i=e('<label for="qty-unlimited">Give me a lot!</label>');r.append(i);var s=e('<input type="checkbox" name="unlimited" id="qty-unlimited">');r.append(s);s.change(function(){if(s.is(":checked")){s.data("original",n.val());n.hide();n.val(0)}else{n.val(s.data("original"));n.show()}});if(n.val()==="0"){s.attr("checked",!0);s.change()}};e("input[name=quantity]").each(function(){i(this)})}(window.jQuery);